# CO₂ Emissions SQL Analysis

This project contains a series of SQL queries that analyze a dataset of carbon dioxide (CO₂) emissions by country and year. The dataset is stored in a table called `co2_emission_project_sql_main_last` (with some queries referencing a similar table, `co2_emissions`). The queries cover a wide range of analytical tasks, including trends, rankings, per capita calculations, moving averages, and country comparisons.

## Table of Contents

- [Dataset Structure](#dataset-structure)
- [Queries Included](#queries-included)
- [Usage](#usage)
- [Notes](#notes)

## Dataset Structure

The main table used in these queries is expected to have the following columns:

- `country`: Name of the country.
- `year`: Year of the emission record.
- `co2_emission_tons`: Total CO₂ emissions (in tons).
- `population_2022`: (Optional) Population of the country in 2022.
- `area`: (Optional) Area of the country (used for efficiency analysis).

## Queries Included

1. **List Distinct Years:**  
   Get all distinct years in the dataset.

2. **Select All Rows (Country, Year, Emissions):**  
   Display all records with country, year, and emissions.

3. **Emissions Threshold in 2022:**  
   Show records where emissions in 2020 exceed 1 billion tons.

4. **Number of Distinct Countries:**  
   Retrieve the list of distinct countries.

5. **Total Emissions by Country (All Years):**  
   Aggregate CO₂ emissions by country.

6. **Average Per Capita Emissions:**  
   Calculate average emissions per capita for each country.

7. **Top 5 Countries by Emissions in 2022:**  
   Rank countries by total emissions in 2022.

8. **Global Emissions Trend:**  
   Show global total emissions by year.

9. **First and Most Emissions Before 1800:**  
   Find the country with the highest emissions before 1800.

10. **India Emissions Trend:**  
    Display India's emissions across years.

11. **Countries with High Average Emissions:**  
    List countries whose average emissions exceed 1 billion tons.

12. **Yearly Emissions Ranking:**  
    Rank countries by emissions for each year.

13. **Country Share in Global Emissions (2022):**  
    Calculate each country's percentage share of global emissions in 2022.

14. **3-Year Rolling Average Emissions:**  
    Compute a 3-year rolling average for each country.

15. **Highest Year-over-Year Growth Rate:**  
    Find the country/year with the highest YoY growth in emissions.

16. **Cumulative Global Emissions:**  
    Show cumulative sum of global emissions by year.

17. **Rising Share of Global Emissions:**  
    Identify countries with the largest increase in their share of global emissions.

18. **Countries with Consistent Decreases:**  
    Find countries with three years of consecutive emission decreases.

19. **5-Year Moving Average of Global Emissions:**  
    Compute a 5-year moving average of total global emissions.

20. **Most Emission-Efficient Country (per Area):**  
    Identify the country with the lowest emissions per area unit in 2020.

## Usage

1. **Preparation**:  
   - Import your emissions dataset into a SQL database as `co2_emission_project_sql_main_last` (or `co2_emissions`).
   - Ensure columns match those described above.

2. **Running Queries**:  
   - Copy the desired SQL query from the provided list.
   - Run it in your SQL environment (e.g., SQLite, PostgreSQL, MySQL, etc.).
   - Review and analyze the results.

## Notes

- Some queries reference `co2_emissions` instead of `co2_emission_project_sql_main_last`. If your table is named differently, adjust accordingly.
- Queries involving window functions (e.g., `RANK()`, `LAG()`, `AVG() OVER`) require a SQL database that supports these features.
- Population and area-related queries require those columns to be populated.
- Emission values are assumed to be in tons.

---

**Author:**  
Generated by Copilot for comprehensive CO₂ emissions SQL analysis.
